<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ê²Œì‹œíŒ</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f7f8fa; }
        .container {
            width: 520px; margin: 60px auto; background: #fff; padding: 40px 34px;
            border-radius: 14px; box-shadow: 0 2px 8px rgba(0,0,0,0.07);
        }
        h2 { color: #2c3e50; text-align: center; margin-bottom: 25px;}
        .board-list { width: 100%; margin-bottom: 26px;}
        .board-list th, .board-list td { padding: 7px 8px; border-bottom: 1px solid #ddd; }
        .board-list th { background: #f0f3fa; }
        .board-list td.title { cursor: pointer; color: #285690;}
        .board-list td.title:hover { text-decoration: underline; }
        .write-btn, .back-btn, .list-btn {
            width: 100%; background: #4078c0; color: white; font-weight: bold;
            border: none; border-radius: 6px; padding: 11px; margin-top: 14px;
            font-size: 16px; cursor: pointer; transition: background 0.18s;
        }
        .write-btn:hover, .back-btn:hover, .list-btn:hover { background: #285690; }
        .list-btn, .back-btn { background: #eee; color: #285690; }
        .list-btn:hover, .back-btn:hover { background: #e0e8f5; }
        .form-group { margin-bottom: 13px;}
        label { display: block; color: #444; margin-bottom: 4px; }
        input[type="text"], textarea {
            width: 100%; box-sizing: border-box; padding: 8px;
            border: 1px solid #ccc; border-radius: 6px; font-size: 15px; margin-bottom: 2px;
        }
        textarea { min-height: 90px; }
        .msg { margin: 15px 0 0 0; text-align: center; font-weight: bold;}
        .success { color: #27ae60; }
        .error { color: #e74c3c; }
    </style>
</head>
<body>
<div class="container">

    <h2>ê²Œì‹œíŒ</h2>

    <div id="search-area">
<!--        <input type="text" id="search" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥">-->
       <input type="text" id="search" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥" oninput="searchPosts(0)"> <!--  ì…ë ¥í•˜ìë§ˆì ë°˜ì‘-->
        <button onclick="searchPosts()">ê²€ìƒ‰</button>
    </div>

    <!-- ê²Œì‹œê¸€ ëª©ë¡ í™”ë©´ -->
    <div id="list-area">
        <button class="write-btn" onclick="showWriteForm()">ê¸€ì“°ê¸°</button>
        <table class="board-list" id="board-table">
            <thead>
            <tr>
                <th>ë²ˆí˜¸</th><th>ì œëª©</th><th>ì‘ì„±ì</th><th>ì‘ì„±ì¼</th>
            </tr>
            </thead>
            <tbody id="board-list-body"></tbody>
        </table>



        <div id="paging" style="text-align:center; margin-top:14px;"></div> <!-- í˜ì´ì§• -->



        <button class="back-btn" onclick="location.href='main.html'">ë©”ì¸ìœ¼ë¡œ</button>
    </div>

    <!-- ê¸€ì“°ê¸° í™”ë©´ -->
    <div id="write-area" style="display:none;">
        <form id="write-form">
            <div class="form-group">
                <label for="title">ì œëª©</label>
                <input type="text" id="title" name="title" required>
            </div>
            <div class="form-group">
                <label for="content">ë‚´ìš©</label>
                <textarea id="content" name="content" required></textarea>
            </div>
            <button type="submit" class="write-btn">ë“±ë¡</button>
            <button type="button" class="list-btn" onclick="showList()">ëª©ë¡</button>
        </form>
        <div class="msg" id="write-msg"></div>
    </div>

    <!-- ìƒì„¸/ìˆ˜ì • í™”ë©´ -->
    <div id="detail-area" style="display:none;">
        <h3 id="detail-title"></h3>
        <div id="detail-content"></div>
        <div style="margin-top:8px;color:#666;font-size:14px;">
            ì‘ì„±ì: <span id="detail-writer"></span>
            <span style="margin-left:10px;">ì‘ì„±ì¼: <span id="detail-date"></span></span>
        </div>
        <button class="write-btn" id="edit-btn" onclick="showEditForm()">ìˆ˜ì •</button>
        <button class="list-btn" onclick="showList()">ëª©ë¡</button>
        <button class="back-btn" onclick="location.href='main.html'">ë©”ì¸ìœ¼ë¡œ</button>
        <button class="write-btn"  id="delete-btn" style="background:#e74c3c;margin-top:6px;" onclick="deleteBoard()">ì‚­ì œ</button>
        <!-- ëŒ“ê¸€/ëŒ€ëŒ“ê¸€ ì˜ì—­ ì¶”ê°€ -->
        <div id="comment-area" style="margin-top:30px;"></div>
    </div>

    <!-- ìˆ˜ì • í™”ë©´ -->
    <div id="edit-area" style="display:none;">
        <form id="edit-form">
            <div class="form-group">
                <label for="edit-title">ì œëª©</label>
                <input type="text" id="edit-title" name="edit-title" required>
            </div>
            <div class="form-group">
                <label for="edit-content">ë‚´ìš©</label>
                <textarea id="edit-content" name="edit-content" required></textarea>
            </div>
            <button type="submit" class="write-btn">ìˆ˜ì • ì™„ë£Œ</button>
            <button type="button" class="list-btn" onclick="showList()">ëª©ë¡</button>
        </form>
        <div class="msg" id="edit-msg"></div>
    </div>



</div>
<script src="fetchWithAuth.js"></script>
<script>
    //ê²Œì‹œê¸€ ê²€ìƒ‰

    let currentPage = 0;
    let pageSize = 10;


    //í˜ì´ì§• ì ìš©
    function searchPosts(page = 0) {
        const keyword = document.getElementById('search').value;
        //fetchWithAuth(`/boards/search?keyword=${encodeURIComponent(keyword)}&page=${page}&size=${pageSize}&sort=title,desc`,{ //ì •ë ¬
      //  fetchWithAuth(`/boards/search?keyword=${encodeURIComponent(keyword)}&page=${page}&size=${pageSize}`,{  // jpa ê²€ìƒ‰
        fetchWithAuth(`/boards/elasticsearch?keyword=${encodeURIComponent(keyword)}&page=${page}&size=${pageSize}`,{ //ì—˜ë¼ìŠ¤í‹±ì„œì¹˜ ê²€ìƒ‰
            credentials: "include", // ì¿ í‚¤ë„ í•­ìƒ ë³´ëƒ„ (ë¡œì»¬, CORS ëª¨ë‘ ì•ˆì „)
            headers: (localStorage.getItem("accessToken"))
                ? { "Authorization": "Bearer " + localStorage.getItem("accessToken") }
                : {}
        })
            .then(res => res.json())
            .then(list => {
                console.log(list); // ì—¬ê¸°ì— ë°”ë¡œ ì°ê¸°
                renderBoardList(list.content || list); // ì•„ë˜ ìƒˆ í•¨ìˆ˜ ì´ìš©
                renderPaging(list);
                currentPage = list.number || 0;
            });
    }

    //í˜ì´ì§• ì ìš©ì „
    // function searchPosts() {
    //     const keyword = document.getElementById('search').value;
    //     fetchWithAuth('/boards/search?keyword=' + encodeURIComponent(keyword),{
    //         credentials: "include", // ì¿ í‚¤ë„ í•­ìƒ ë³´ëƒ„ (ë¡œì»¬, CORS ëª¨ë‘ ì•ˆì „)
    //         headers: (localStorage.getItem("accessToken"))
    //             ? { "Authorization": "Bearer " + localStorage.getItem("accessToken") }
    //             : {}
    //     })
    //         .then(res => res.json())
    //         .then(list => {
    //             renderBoardList(list); // ì•„ë˜ ìƒˆ í•¨ìˆ˜ ì´ìš©
    //         });
    // }

    // ê¸°ì¡´ ëª©ë¡ ê·¸ë¦¬ëŠ” ë¡œì§ì„ í•¨ìˆ˜ë¡œ ë¶„ë¦¬
    function renderBoardList(list) {
        // listê°€ null/undefinedê±°ë‚˜ ë°°ì—´ì´ ì•„ë‹Œ ê²½ìš° (content í•„ë“œë„ ì²´í¬)
        let posts = Array.isArray(list) ? list
            : (list && Array.isArray(list.content)) ? list.content
                : [];

        if (!posts.length) {
            document.getElementById('board-list-body').innerHTML = '<tr><td colspan="4" style="text-align:center;">ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
            return;
        }


        let html = '';
        list.forEach((b, idx) => {
            html += `<tr>
            <td>${b.id}</td>
            <td class="title" onclick="showDetail(${b.id})">${b.title}</td>
            <td>${b.username || b.user_id}</td>
            <td>${b.created_date ? b.created_date.substring(0,10) : ''}</td>
        </tr>`;
        });
        document.getElementById('board-list-body').innerHTML = html;
    }


    // ======= ê²Œì‹œê¸€ ëª©ë¡ =======
    //í˜ì´ì§• ì ìš©
    function loadBoards(page = 0) {
        //fetchWithAuth(`/boards?page=${page}&size=${pageSize}&sort=title,desc`, { //ì •ë ¬
        fetchWithAuth(`/boards?page=${page}&size=${pageSize}`, {
            credentials: "include", // ì¿ í‚¤ë„ í•­ìƒ ë³´ëƒ„ (ë¡œì»¬, CORS ëª¨ë‘ ì•ˆì „)
            headers: (localStorage.getItem("accessToken"))
                ? { "Authorization": "Bearer " + localStorage.getItem("accessToken") }
                : {}
        })
            .then(res => res.json())
            .then(list => {
                console.log(list); // ì—¬ê¸°ì— ë°”ë¡œ ì°ê¸°
                renderBoardList(list.content || list);  //page ê°ì²´
                renderPaging(list);
                currentPage = list.number;
            })
            .catch(err => {
                alert("ì—ëŸ¬: " + err.message);
            });
    }
    loadBoards(0)

    //í˜ì´ì§• ì ìš© ì „
    // function loadBoards() {
    //     fetchWithAuth('/boards', {
    //         credentials: "include", // ì¿ í‚¤ë„ í•­ìƒ ë³´ëƒ„ (ë¡œì»¬, CORS ëª¨ë‘ ì•ˆì „)
    //         headers: (localStorage.getItem("accessToken"))
    //             ? { "Authorization": "Bearer " + localStorage.getItem("accessToken") }
    //             : {}
    //     })
    //         .then(res => res.json())
    //         .then(list => {
    //             renderBoardList(list);
    //
    //         })
    //         .catch(err => {
    //             alert("ì—ëŸ¬: " + err.message);
    //         });
    // }
    // loadBoards();

    function showList() {
        document.getElementById('list-area').style.display = '';
        document.getElementById('write-area').style.display = 'none';
        document.getElementById('detail-area').style.display = 'none';
        document.getElementById('edit-area').style.display = 'none';
        document.getElementById('search-area').style.display = ''; // â† ê²€ìƒ‰ì°½ ë³´ì´ê¸°
        loadBoards();
    }

    function showWriteForm() {
        document.getElementById('list-area').style.display = 'none';
        document.getElementById('write-area').style.display = '';
        document.getElementById('detail-area').style.display = 'none';
        document.getElementById('edit-area').style.display = 'none';
        document.getElementById('search-area').style.display = 'none'; // â† ê²€ìƒ‰ì°½ ìˆ¨ê¸°ê¸°
        document.getElementById('write-form').reset();
        document.getElementById('write-msg').innerHTML = '';
    }

    document.getElementById('write-form').addEventListener('submit', function(e) {
        e.preventDefault();
        const userId = localStorage.getItem("user_id");
        if (!userId) {
            document.getElementById('write-msg').innerHTML = `<span class="error">ë¡œê·¸ì¸ í›„ ì‘ì„± ê°€ëŠ¥í•©ë‹ˆë‹¤.</span>`;
            return;
        }
        const data = {
            title: document.getElementById('title').value,
            content: document.getElementById('content').value,
            userId: Number(userId)
        };
        fetchWithAuth('/boards', {
            credentials: "include", // ì¿ í‚¤ë„ í•­ìƒ ë³´ëƒ„ (ë¡œì»¬, CORS ëª¨ë‘ ì•ˆì „)
            method: 'POST',
            headers: Object.assign(
                { 'Content-Type': 'application/json' },
                (localStorage.getItem("accessToken")) ? { "Authorization": "Bearer " + localStorage.getItem("accessToken") } : {}
            ),
            body: JSON.stringify(data)
        })
            .then(res => {
                if(res.ok) return res.json();
                return res.text().then(msg => { throw new Error(msg); });
            })
            .then(() => {
                showList();
            })
            .catch(err => {
                document.getElementById('write-msg').innerHTML = `<span class="error">ë“±ë¡ ì‹¤íŒ¨: ${err.message}</span>`;
            });
    });

    let currentBoardId = null;
    function showDetail(id) {

        fetchWithAuth(`/boards/${id}`, {
            credentials: "include", // ì¿ í‚¤ë„ í•­ìƒ ë³´ëƒ„ (ë¡œì»¬, CORS ëª¨ë‘ ì•ˆì „)
            headers: (localStorage.getItem("accessToken"))
                ? { "Authorization": "Bearer " + localStorage.getItem("accessToken") }
                : {}
        })
            .then(res => res.json())
            .then(board => {
                currentBoardId = board.id;
                document.getElementById('detail-title').textContent = board.title;
                document.getElementById('detail-content').textContent = board.content;
                document.getElementById('detail-writer').textContent = board.user_id;

                console.log("localStorage.getItem(user_id) = ",localStorage.getItem("user_id"))
                console.log("board.user_id = ",board.user_id)

                document.getElementById('detail-writer').textContent = board.username;
                document.getElementById('detail-date').textContent = board.created_date ? board.created_date.substring(0,10) : '';
                document.getElementById('list-area').style.display = 'none';
                document.getElementById('write-area').style.display = 'none';
                document.getElementById('detail-area').style.display = '';
                document.getElementById('edit-area').style.display = 'none';
                document.getElementById('search-area').style.display = 'none'; // â† ê²€ìƒ‰ì°½ ìˆ¨ê¸°ê¸°
                const myUserId = localStorage.getItem("user_id");
                if (String(board.user_id) === String(myUserId)) {
                    document.getElementById('edit-btn').style.display = '';
                    document.getElementById('delete-btn').style.display = '';
                } else {
                    document.getElementById('edit-btn').style.display = 'none';
                    document.getElementById('delete-btn').style.display = 'none';
                }
                loadComments(board.id); // ëŒ“ê¸€ ë¡œë”©!
            });
    }
    function showEditForm() {
        fetchWithAuth(`/boards/${currentBoardId}`, {
            credentials: "include", // ì¿ í‚¤ë„ í•­ìƒ ë³´ëƒ„ (ë¡œì»¬, CORS ëª¨ë‘ ì•ˆì „)
            headers: (localStorage.getItem("accessToken"))
                ? { "Authorization": "Bearer " + localStorage.getItem("accessToken") }
                : {}
        })
            .then(res => res.json())
            .then(board => {
                document.getElementById('edit-title').value = board.title;
                document.getElementById('edit-content').value = board.content;
                document.getElementById('list-area').style.display = 'none';
                document.getElementById('write-area').style.display = 'none';
                document.getElementById('detail-area').style.display = 'none';
                document.getElementById('edit-area').style.display = '';
                document.getElementById('edit-msg').innerHTML = '';
                document.getElementById('search-area').style.display = 'none'; // â† ê²€ìƒ‰ì°½ ìˆ¨ê¸°ê¸°
            });
    }
    document.getElementById('edit-form').addEventListener('submit', function(e) {
        e.preventDefault();
        const data = {
            title: document.getElementById('edit-title').value,
            content: document.getElementById('edit-content').value
        };
        fetchWithAuth(`/boards/${currentBoardId}`, {
            credentials: "include", // ì¿ í‚¤ë„ í•­ìƒ ë³´ëƒ„ (ë¡œì»¬, CORS ëª¨ë‘ ì•ˆì „)
            method: 'PUT',
            headers: Object.assign(
                { 'Content-Type': 'application/json' },
                (localStorage.getItem("accessToken")) ? { "Authorization": "Bearer " + localStorage.getItem("accessToken") } : {}
            ),
            body: JSON.stringify(data)
        })
            .then(res => {
                if(res.ok) return res.json();
                return res.text().then(msg => { throw new Error(msg); });
            })
            .then(() => {
                showList();
            })
            .catch(err => {
                document.getElementById('edit-msg').innerHTML = `<span class="error">ìˆ˜ì • ì‹¤íŒ¨: ${err.message}</span>`;
            });
    });
    function deleteBoard() {
        if(!confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
        fetchWithAuth(`/boards/${currentBoardId}`, {
            credentials: "include", // ì¿ í‚¤ë„ í•­ìƒ ë³´ëƒ„ (ë¡œì»¬, CORS ëª¨ë‘ ì•ˆì „)
            method: 'DELETE',
            headers: (localStorage.getItem("accessToken"))
                ? { "Authorization": "Bearer " + localStorage.getItem("accessToken") }
                : {}
        })
            .then(res => {
                if(res.ok) showList();
                else return res.text().then(msg => { throw new Error(msg); });
            })
            .catch(err => {
                alert('ì‚­ì œ ì‹¤íŒ¨: ' + err.message);
            });
    }


    // ======= [ëŒ“ê¸€/ëŒ€ëŒ“ê¸€ ì˜ì—­] =======

    // ëŒ“ê¸€ ëª©ë¡ ë¡œë”©
    function loadComments(boardId) {
        fetchWithAuth(`/api/comments?boardId=${boardId}`, {
            credentials: "include", // ì¿ í‚¤ë„ í•­ìƒ ë³´ëƒ„ (ë¡œì»¬, CORS ëª¨ë‘ ì•ˆì „)
            headers: (localStorage.getItem("accessToken"))
                ? { "Authorization": "Bearer " + localStorage.getItem("accessToken") } : {}
        })
            .then(res => res.json())
            .then(list => {
                const commentTree = buildCommentTree(list);
                let html = `
            <h4 style="margin-top:20px">ğŸ’¬ ëŒ“ê¸€</h4>
            <div style="margin-bottom:16px;">
                <textarea id="comment-content" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”" style="width:90%;height:50px"></textarea>
                <button onclick="writeComment()" class="write-btn" style="width:80px; padding:8px 0; margin-left:5px;">ë“±ë¡</button>
                <div class="msg" id="comment-msg"></div>
            </div>
            <div>${renderCommentList(commentTree)}</div>
            `;
                document.getElementById('comment-area').innerHTML = html;
            });

        console.log("comments accessToken = ", localStorage.getItem("accessToken"));

    }

    // í‰íƒ„í™”ëœ ëŒ“ê¸€ë¦¬ìŠ¤íŠ¸ â†’ ê³„ì¸µêµ¬ì¡° íŠ¸ë¦¬
    function buildCommentTree(comments) {
        const map = {};
        comments.forEach(c => map[c.id] = { ...c, children: [] });
        const tree = [];
        comments.forEach(c => {
            if (c.parentId) map[c.parentId]?.children.push(map[c.id]);
            else tree.push(map[c.id]);
        });
        return tree;
    }

    // ëŒ“ê¸€/ëŒ€ëŒ“ê¸€ HTML ìƒì„±
    function renderCommentList(list, depth = 0) {
        if (!list || !list.length) return '';
        const myUserId = localStorage.getItem("user_id");
        let html = '';
        list.forEach(c => {
            html += `
        <div style="margin-left:${depth*25}px; margin-bottom:7px; border-bottom:1px solid #eee;padding-bottom:6px;">
            <b>${c.username}</b> <span style="color:#999;">${c.createdDate ? c.createdDate.substring(0,16) : ''}</span><br>
            <span>${c.content}</span>
            <div style="margin-top:3px;">
                <button onclick="showReplyForm(${c.id}, '${c.username}', ${depth+1})" style="font-size:12px;background:#e0e8f5;border:none;padding:2px 10px;border-radius:10px;color:#4078c0;cursor:pointer;">ë‹µê¸€</button>
                ${c.user_id == myUserId
                ? `<button onclick="deleteComment(${c.id})" style="font-size:12px;background:#ffe0e0;border:none;padding:2px 10px;border-radius:10px;color:#d35400;cursor:pointer;margin-left:6px;">ì‚­ì œ</button>`
                : ""}
            </div>
            <div id="reply-form-${c.id}"></div>
            ${renderCommentList(c.children, depth + 1)}
        </div>
        `;
        });
        return html;
    }

    //ëŒ“ê¸€ ì‚­ì œ
    function deleteComment(commentId) {
        if (!confirm("ëŒ“ê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
        fetchWithAuth(`/api/comments/${commentId}`, {
            credentials: "include",
            method: "DELETE",
            headers: (localStorage.getItem("accessToken"))
                ? { "Authorization": "Bearer " + localStorage.getItem("accessToken") }
                : {}
        })
            .then(res => {
                if (res.ok) {
                    loadComments(currentBoardId); // ëŒ“ê¸€ ëª©ë¡ ê°±ì‹ 
                } else {
                    return res.text().then(msg => { throw new Error(msg); });
                }
            })
            .catch(err => {
                alert("ëŒ“ê¸€ ì‚­ì œ ì‹¤íŒ¨: " + err.message);
            });
    }



    // ëŒ“ê¸€ ë“±ë¡
    function writeComment(parentId) {
        const boardId = currentBoardId;
        const content = parentId
            ? document.getElementById('reply-content-' + parentId).value
            : document.getElementById('comment-content').value;
        if (!content || content.trim().length === 0) {
            document.getElementById(parentId ? 'reply-msg-' + parentId : 'comment-msg').innerHTML =
                `<span class="error">ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”.</span>`;
            return;
        }
        const username = localStorage.getItem("username") || "ìµëª…";
        const userId = localStorage.getItem("user_id");
        fetchWithAuth('/api/comments', {
            credentials: "include", // ì¿ í‚¤ë„ í•­ìƒ ë³´ëƒ„ (ë¡œì»¬, CORS ëª¨ë‘ ì•ˆì „)
            method: 'POST',
            headers: Object.assign(
                { 'Content-Type': 'application/json' },
                (localStorage.getItem("accessToken")) ? { "Authorization": "Bearer " + localStorage.getItem("accessToken") } : {}
            ),
            body: JSON.stringify({
                boardId, username, content,userId,
                parentId: parentId || null
            })
        })
            .then(res => {
                if (res.ok) return res.json();
                return res.text().then(msg => { throw new Error(msg); });
            })
            .then(() => {
                loadComments(boardId);
            })
            .catch(err => {
                document.getElementById(parentId ? 'reply-msg-' + parentId : 'comment-msg').innerHTML =
                    `<span class="error">ë“±ë¡ ì‹¤íŒ¨: ${err.message}</span>`;
            });
    }


    // ëŒ€ëŒ“ê¸€ í¼ ë³´ì—¬ì£¼ê¸°
    function showReplyForm(parentId, parentUsername, depth) {
        document.getElementById('reply-form-' + parentId).innerHTML = `
            <div style="margin-top:5px;">
                <textarea id="reply-content-${parentId}" placeholder="@${parentUsername} ì—ê²Œ ë‹µê¸€" style="width:80%;height:35px;"></textarea>
                <button onclick="writeComment(${parentId})" class="write-btn" style="width:60px;padding:5px 0;margin-left:4px;">ë“±ë¡</button>
                <span class="msg" id="reply-msg-${parentId}" style="font-size:12px"></span>
            </div>
        `;
    }



    //í˜ì´ì§• ì˜ì—­
    // í˜ì´ì§• ë²„íŠ¼
    function renderPaging(pageData) {
        const pagingDiv = document.getElementById('paging');
        if (!pagingDiv) return;

        const currentPage = pageData.number;
        const totalPages = pageData.totalPages;

        const groupSize = 10; // 10ê°œì”© ëŠê¸°
        const currentGroup = Math.floor(currentPage / groupSize);
        const start = currentGroup * groupSize;
        const end = Math.min(start + groupSize, totalPages);

        let html = '';

        if (start > 0) {
            html += `<button onclick="movePage(${start - 1})">ì´ì „</button>`;
        }

        for (let i = start; i < end; i++) {
            html += `<button onclick="movePage(${i})"${i === currentPage ? ' style="font-weight:bold;color:red"' : ''}>${i + 1}</button>`;
        }

        if (end < totalPages) {
            html += `<button onclick="movePage(${end})">ë‹¤ìŒ</button>`;
        }

        pagingDiv.innerHTML = html;
    }



    function movePage(page) {
        const keyword = document.getElementById('search').value;
        if (keyword && keyword.trim().length > 0) {
            searchPosts(page);
        } else {
            loadBoards(page);
        }
    }
</script>
</body>
</html>
