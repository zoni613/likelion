


//ì „ì²´ ìƒ¤ë“œ ìƒíƒœ ë³´ê¸°
GET /_cat/shards/board-index?v

//í˜„ì¬ í´ëŸ¬ìŠ¤í„°ì— ì‚´ì•„ìˆëŠ” ë…¸ë“œ, í• ë‹¹ ìƒ¤ë“œ, ì—­í•  ë“± í™•ì¸
GET /_cat/nodes?v


//í˜„ì¬ ì…‹íŒ… í™•ì¸
GET /board-index/_settings
GET board-index/_mapping

//í˜„ì¬ ì¸ë±ìŠ¤ ë°ì´í„° ë³´ê¸°
GET board-index/_search
{
  "query": {
    "match_all": {}
  }
}

//í˜„ì¬ ì¸ë±ìŠ¤ì˜ ë°ì´í„° 1000ê°œ ë³´ê¸°
GET board-index/_search
{
  "size": 1000,
  "query": {
    "match_all": {}
  }
}

//springì´ í¬í•¨ëœ ë°ì´í„° ê²€ìƒ‰
GET board-index/_search
{
  "query": {
    "match": {
      "title": "spring"
    }
  }
}


GET board-index/_search
{
  "query": {
    "term": {
      "_id": "12345"
    }
  }
}

//Elasticsearch í´ëŸ¬ìŠ¤í„°ì— ìˆëŠ” ëª¨ë“  ì¸ë±ìŠ¤ì˜ ìƒíƒœ, ë¬¸ì„œ ìˆ˜, í¬ê¸° ë“±ì„ ìš”ì•½í•´ì„œ ë³´ì—¬ì¤Œ
GET /_cat/indices?v

//ê²€ìƒ‰ê²°ê³¼ 1ê±´ë§Œ ê°€ì ¸ì˜¤ê¸°
GET /board-index/_search?size=1

//idê°€ 5ì¸ ë°ì´í„° ì‚­ì œ
DELETE board-index/_doc/5

//ì¸ë±ìŠ¤ ì‚­ì œ
DELETE board-index/


//ë¶„ì„ê¸° í…ŒìŠ¤íŠ¸ ê¸°ëŠ¥
POST board-index/_analyze
{
  "text": "ì›¹ì†Œì¼“ì™€ íŒŒì´ì¬ì˜ ì˜ˆì œ 0"
}



//ì¤‘ê°„ê²€ìƒ‰,ì´ˆì„±, ìë™ì™„ì„±í¬í•¨ ì¸ë±ìŠ¤
PUT /board-index
{
  "settings": {

    "number_of_shards": 3,  //ìƒ¤ë“œ 3ê°œ
    "number_of_replicas": 1,  //ë³µì œë³¸ 1ê°œ
    "index.max_ngram_diff": 8,  // 8ê¸€ìë¥¼ ê° ngram_filter ì—ì„œ ìµœëŒ€ í—ˆìš©ì¹˜ (max - min)  ê°„ê·¹  -> "min_gramê³¼ max_gramì˜ ì°¨ì´ê°€ 8ê¹Œì§€ í—ˆìš©ëœë‹¤"ëŠ” ëœ»
                                    //"hello" â†’ ngram(2~10) ê²°ê³¼   ->  he, el, ll, lo, hel, ell, llo, hell, ello, hello
                                     //ê°„ê²©ì´ í¬ë©´ ì„±ëŠ¥ì— ë¬´ë¦¬ê°€ ê°
                                     // ì˜ˆë¥¼ ë“¤ì–´ "elasticsearch" (13ê¸€ì)ì—ì„œ
                                     // min_gram: 2, max_gram: 3 â†’ ì¡°ê° 2~3ê¸€ìë§Œ ë§Œë“¦(ì ë‹¹)
                                     // min_gram: 2, max_gram: 10 â†’ 2~10ê¸€ì ëª¨ë“  ì¡°í•©ì„ ë§Œë“¦(ìˆ˜ë°± ê°œ ìƒì„±)

    "analysis": {                       // ë¬¸ì¥ ë¶„ì„ê¸° ì„¤ì • ì˜ì—­

      "filter": {                        // ğŸ”¹ [1]"filter ì •ì˜ ì˜ì—­" (ë‹¨ì–´ ë‹¨ìœ„ë¡œ ì˜ë¼ë‚¸ í›„ ê·¸ ë‹¨ì–´ë“¤ì„ ì–´ë–»ê²Œ ë³€í˜•í• ì§€ ì •ì˜í•˜ëŠ” ì˜ì—­)

        "autocomplete_filter": {           // ë‚´ê°€ ì •ì˜í•œ filter ì´ë¦„
          "type": "edge_ngram",            // ğŸ” ìë™ì™„ì„±ìš© í•„í„°: ì•ì—ì„œë¶€í„° ì˜ê²Œ ìë¦„   ì˜ˆ) ì˜ˆ: "spring" â†’ "s", "sp", "spr", "spri", "sprin", "spring"
          "min_gram": 1,                    // ìµœì†Œ ëª‡ ê¸€ìë¶€í„° ìë¥¼ì§€
          "max_gram": 20                    // ìµœëŒ€ ëª‡ ê¸€ìê¹Œì§€ ìë¥¼ì§€
        },

        //ì¤‘ê°„ ë¬¸ì ê²€ìƒ‰
        "ngram_filter": {
          "type": "ngram",
          "min_gram": 2,
          "max_gram": 10
        },

        //ì´ˆì„±
        "chosung_filter": {
           "type": "hanhinsam_chosung"
        }

      },

      "analyzer": {                        // ì‹¤ì œë¡œ ë¬¸ì¥ì„ ë¶„ì„í•  ë•Œ ì‚¬ìš©í•  ë¶„ì„ê¸°ë¥¼ ì •ì˜í•˜ëŠ” ê³³ (ìœ„ì—ì„œ ì •ì˜í•  í•„í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” ê³³)

        "autocomplete_analyzer": {         // ë‚´ê°€ ì •ì˜í•œ ì»¤ìŠ¤í…€ ë¶„ì„ê¸° ì´ë¦„
          "type": "custom",                // ë‚´ê°€ ë§Œë“  ì»¤ìŠ¤í…€ ë¶„ì„ê¸° ì‚¬ìš©
          "tokenizer": "standard",         // ë‹¨ì–´ ë‹¨ìœ„ë¡œ ë¶„ë¦¬  (ê³µë°±, íŠ¹ìˆ˜ë¬¸ì ë“± ê¸°ì¤€ìœ¼ë¡œ ë‹¨ì–´ ë¶„ë¦¬)
          "filter": [                       // ğŸ”¸ [2] "ì–´ë–¤ í•„í„°ë“¤ì„ ì‚¬ìš©í• ì§€ ë‚˜ì—´"
            "lowercase",                   // ì†Œë¬¸ìë¡œ í†µì¼
            "autocomplete_filter"         // ìœ„ì—ì„œ ì •ì˜í•œ í•„í„°ë¥¼ ì‚¬ìš© (ì ‘ë‘ì‚¬ ì¡°ê° ìƒì„±)  ì˜ˆ) ì˜ˆ: "spring" â†’ "s", "sp", "spr", "spri", "sprin", "spring"
          ]
        },

         "ngram_analyzer": {
           "type": "custom",
           "tokenizer": "standard",
           "filter": ["lowercase", "ngram_filter"]
         },

        "chosung_analyzer": {
          "type": "custom",
          "tokenizer": "standard",
          "filter": [
            "chosung_filter"
          ]
        }

      }
    }



  },

  "mappings": {
    "properties": {

      "_class": {                          //spring data elasticsearchì—ì„œ ê°ì²´ë¥¼ ì €ì¥í•  ë•Œ ìë™ìœ¼ë¡œ ì¶”ê°€í•˜ëŠ” ë©”íƒ€ë°ì´í„°
        "type": "keyword",
        "index": false,                   // ğŸ”’ ì €ì¥ì€ ë˜ì§€ë§Œ ê²€ìƒ‰/ì •ë ¬ì—ì„œ ì œì™¸
        "doc_values": false              // ğŸ”’ ì§‘ê³„ì—ë„ ì‚¬ìš© ì•ˆ í•¨
      },

      "content": {
        "type": "text",                     //  âœ… ìì—°ì–´ ë¬¸ì¥ì„ ê²€ìƒ‰í•  ìˆ˜ ìˆëŠ” í•„ë“œë¼ëŠ” ì˜ë¯¸
        "analyzer": "autocomplete_analyzer", // âœ… (ì¸ë±ì‹±ìš©)  í…ìŠ¤íŠ¸ë¥¼ ì–´ë–»ê²Œ ìª¼ê°œì„œ ìƒ‰ì¸(ì €ì¥)í• ì§€  (ìœ„ settings -> analysis -> analyzer ì—ì„œ ë§Œë“  ë¶„ì„ê¸° ì‚¬ìš©)
        "search_analyzer": "standard",       // âœ… (ê²€ìƒ‰ìš©)  ê²€ìƒ‰ ì‹œì—ëŠ” ì–´ë–»ê²Œ ë¶„ì„í•´ì„œ ì°¾ì„ì§€

        "fields": {

          "chosung": {                        // ì´ˆì„± ê²€ìƒ‰ ì „ìš© í•„ë“œ
            "type": "text",
            "analyzer": "chosung_analyzer"      // âœ… ì´ˆì„±ê²€ìƒ‰
          },

          "keyword": {
            "type": "keyword",
            "ignore_above": 256          // âœ… 256ì ì´ìƒì¸ ë¬¸ìì—´ì€ ì¸ë±ì‹±í•˜ì§€ ì•Šê² ë‹¤ëŠ” ì„¤ì •  (ì¼ë°˜ì ìœ¼ë¡œ Elasticsearchì˜ ì„±ëŠ¥ ë³´í˜¸ë¥¼ ìœ„í•œ ì œí•œ)
          },

          "ngram": {
            "type": "text",
            "analyzer": "ngram_analyzer"
          }

        }
      },


      "title": {
        "type": "text",
        "analyzer": "autocomplete_analyzer",
        "search_analyzer": "standard",
        "fields": {

          "chosung": {                               // ì´ˆì„± ê²€ìƒ‰ ì „ìš© í•„ë“œ
            "type": "text",
            "analyzer": "chosung_analyzer"
          },

          "keyword": {
            "type": "keyword",
            "ignore_above": 256
          },

            "ngram": {
            "type": "text",
            "analyzer": "ngram_analyzer"
          }
        }
      },


      "id": {
        "type": "text",                   // âš ï¸ ì›ë˜ëŠ” keywordë¡œ ì“°ëŠ” ê²Œ ë” ì¢‹ìŒ (ì‹ë³„ìë‹ˆê¹Œ)
        "fields": {
          "keyword": {
            "type": "keyword",
            "ignore_above": 256
          }
        }
      },

      "userId": {
        "type": "long"                    // ì‚¬ìš©ì ID (ì •ìˆ˜í˜• í•„í„°/ì •ë ¬ ê°€ëŠ¥)
      },

      "username": {
        "type": "text",                   // ì‚¬ìš©ì ì´ë¦„ (ê²€ìƒ‰ìš©)
        "fields": {
          "keyword": {
            "type": "keyword",
            "ignore_above": 256          // ì •ë ¬/ì§‘ê³„ìš©
          }
        }
      },

      "created_date": {
        "type": "text",                   // âš ï¸ ë‚ ì§œë¡œ ì“¸ ê±°ë©´ ë‚˜ì¤‘ì— dateë¡œ ë°”ê¾¸ëŠ” ê²Œ ì¢‹ìŒ
        "fields": {
          "keyword": {
            "type": "keyword",
            "ignore_above": 256
          }
        }
      },

      "updated_date": {
        "type": "text",
        "fields": {
          "keyword": {
            "type": "keyword",
            "ignore_above": 256
          }
        }
      }

    }
  }
}

